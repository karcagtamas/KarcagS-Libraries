@page "/counter"
@using KarcagS.Blazor.Common.Http
@using System.ComponentModel.DataAnnotations

<PageTitle>Counter</PageTitle>

<h1>Counter</h1>

<p role="status">Current count: @currentCount</p>

<button class="btn btn-primary" @onclick="IncrementCount">Click me</button>

@code {
    [Inject]
    private IHttpService HttpService { get; set; } = default!;

    [Inject]
    private HttpClient Client { get; set; } = default!;

    private int currentCount = 0;

    private async void IncrementCount()
    {
        await HttpService.Post<TestModel>(new HttpSettings("https://localhost:7205/weatherforecast"), new TestModel { }).Execute();
        //sawait HttpService.Get<TestModel>(new HttpSettings("https://localhost:7205/weatherforecast")).Execute();

        //await Client.GetFromJsonAsync<TestModel>("https://localhost:7205/weatherforecast");
        await Client.PostAsJsonAsync<TestModel>("https://localhost:7205/weatherforecast", new TestModel { });
    }

    public class TestModel
    {
        [Required]
        public int? Id { get; set; }

        [Required]
        public int Number { get; set; }

        [Required]
        public DateTime? DateTime { get; set; }

        [Required]
        [MaxLength(20)]
        public string Name { get; set; } = string.Empty;
    }
}
